-- 体育の日	十月の第二月曜日
CREATE OR REPLACE FUNCTION holidays_in_japan.IS_HEALTH_SPORTS_DAY(d DATE)
AS (
  d BETWEEN "1966-01-01" AND "1999-12-31" AND EXTRACT(MONTH FROM d) = 10 AND EXTRACT(DAY FROM d) = 10 OR
  d BETWEEN "2000-01-01" AND "2019-12-31" AND EXTRACT(MONTH FROM d) = 10 AND EXTRACT(DAYOFWEEK FROM d) =
  2 AND EXTRACT(DAY FROM d) BETWEEN 8 AND 14
);
